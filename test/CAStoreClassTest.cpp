#include "CAStoreClass.h"
#include "gtest/gtest.h"

TEST(CAStoreClassTest, AddCA_1) {
	// Autoridade_Certificadora_da_Justica_v5.crt
	const char *pem = "-----BEGIN CERTIFICATE-----\nMIIGWTCCBEGgAwIBAgIBBzANBgkqhkiG9w0BAQ0FADCBlzELMAkGA1UEBhMCQlIx\nEzARBgNVBAoMCklDUC1CcmFzaWwxPTA7BgNVBAsMNEluc3RpdHV0byBOYWNpb25h\nbCBkZSBUZWNub2xvZ2lhIGRhIEluZm9ybWFjYW8gLSBJVEkxNDAyBgNVBAMMK0F1\ndG9yaWRhZGUgQ2VydGlmaWNhZG9yYSBSYWl6IEJyYXNpbGVpcmEgdjUwHhcNMTYx\nMDE5MTIxODIxWhcNMjkwMzAyMTIwMDIxWjCBiTELMAkGA1UEBhMCQlIxEzARBgNV\nBAoMCklDUC1CcmFzaWwxNDAyBgNVBAsMK0F1dG9yaWRhZGUgQ2VydGlmaWNhZG9y\nYSBSYWl6IEJyYXNpbGVpcmEgdjUxLzAtBgNVBAMMJkF1dG9yaWRhZGUgQ2VydGlm\naWNhZG9yYSBkYSBKdXN0aWNhIHY1MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIIC\nCgKCAgEA1VwO99CodJRRSdTWyG9BLRp69RvpxhXg6PQIZapVNpwrliYZL3DKU5yP\nb5XaE4aBFfWPpEM5tfMvEfwAGxCRhyR7d9dnKC5vDeFbsNK5k+e5Vllpsr//jfpZ\nLZWWnyOqhI2yRwngkYlI1QyiPh0v+jvHYi2XlysxjcOU1L75L3s9iC1hWnmsF8w9\nFzNKfPlz6KmRTCg8Sv29pv56FXkBnW4lOoov87chYZ7kW6DBAeOvAXPwdlF4+vRP\nqn7iSFzibFcb9CxQpgFmjfxV3Zn7lZ/g3zeyQoYIHReh+oWmhXj+NpTsMqsE050c\nGZJ6p4lfRcK6dtZIn4ki5lf7xnOQbIQAiGWh4LgvsA+sgLpC/ZVeRWiJUTOQT7Tm\n5KNzX512XLxb5EJ6ew8hkQf9pWwnZDOewOMdlc1edSBC4RpmJrfBcTiERG5Z8Ehx\nv0WbSk8ktXhvobrnoCqCjDWRvkGc+zQMywWyWyniSqi1K9LZs4v+aWgYrnuv83fM\nxlIA1FTw1m7Cj5OKGRQ2uoqA/NFQMLDOLwXWrfMVBkPqCmFiWrw/BZPJr7KV8jVZ\ntcmdnzcvPh66iVdWlLXXKFbR6tzTiCDzN/NBlDiiVvlxhsWcM1J6TZFUu6u5TPr9\nRFfGXFm7+F8nQRmNurddZE8qBKCwPZVZ2fCV27zMUh0C/IGEnT0CAwEAAaOBuzCB\nuDAdBgNVHQ4EFgQUmSbuAfOve52YFQTpTaU6BDeYC4AwDwYDVR0TAQH/BAUwAwEB\n/zAOBgNVHQ8BAf8EBAMCAQYwFAYDVR0gBA0wCzAJBgVgTAEBEzAAMD8GA1UdHwQ4\nMDYwNKAyoDCGLmh0dHA6Ly9hY3JhaXouaWNwYnJhc2lsLmdvdi5ici9MQ1JhY3Jh\naXp2NS5jcmwwHwYDVR0jBBgwFoAUaai+ddnE72znE0XkYW7laPi2QF4wDQYJKoZI\nhvcNAQENBQADggIBAHj1XLidXFF77nnmEJOwTtCeXP6zf3LTOw/KQunPbR4tr+LG\ngRC0LLN2q+spjF8hvxzXgv99AzLx2AM+as5LkfSspChMJS9U3jmy8gDGRUHvAkXJ\nuBJhPSl0qBmBAmya142QD/52Z3FnZjDSh263TmOvGWfcpQZ9zLTcA5SCUicmg6nA\nijuFJxzTDU1caZzZQruYL1qhSvyN5fQV5VTDzZmrcfcIgYJX7PCn4srPRol0jUcj\nOgkgaQJ35ZCzsSm5FgCgLjWv+7DuYeBT/s9wVE6/U3jD4hTzhXyRWrQz1HPSzvGf\nENCDmqHmuv88bzfMfSH0I/xTj7jbjo4hezgz9MCtZNF/aX4KWQreLp8+LtO/vbic\nT+4IZj93ta3Ba2EginYsWT5q5tdxuT4UfMvr/4lqq+ESry7o3dIh+LJjJgPVk9vb\nXMYHSBvjlGXb3+NOMd+1CTE7w/QdbPWZVANVS1fAKEQHotaXQZSMkC/AAdlRR2Eh\niijnMSE+XlGHv4HDogvqFh/diQY4jUMeDI5JMWlL2HrR5UHt6rIEAspiPwwV4bOm\ni2TAQBUQNeOoqaDVjimOlCxtoHG+FqWTsQF4o5K+BbgCbzg1Cw5ysiG2fITHWSZx\nlcjLGNVFabr8kBjLMQFayVnmj0c8yprod+dHY4bi8uTJuQpmTzxaQNrTws2V\n-----END CERTIFICATE-----";
    CAStoreClass store;

    EXPECT_EQ(store.AddCA_PEM(pem), true);
}

TEST(CAStoreClassTest, AddCA_2) {
    // AC_VALID-JUS_CODESIGNING_v5.crt
    const char *pem = "-----BEGIN CERTIFICATE-----\nMIIGyjCCBLKgAwIBAgIBDjANBgkqhkiG9w0BAQ0FADCBiTELMAkGA1UEBhMCQlIx\nEzARBgNVBAoMCklDUC1CcmFzaWwxNDAyBgNVBAsMK0F1dG9yaWRhZGUgQ2VydGlm\naWNhZG9yYSBSYWl6IEJyYXNpbGVpcmEgdjUxLzAtBgNVBAMMJkF1dG9yaWRhZGUg\nQ2VydGlmaWNhZG9yYSBkYSBKdXN0aWNhIHY1MB4XDTE3MTIxOTEzNTIxOVoXDTI5\nMDIyMDEzNTIxOVowgY8xCzAJBgNVBAYTAkJSMRMwEQYDVQQKEwpJQ1AtQnJhc2ls\nMS8wLQYDVQQLEyZBdXRvcmlkYWRlIENlcnRpZmljYWRvcmEgZGEgSnVzdGljYSB2\nNTEUMBIGA1UECxMLQ09ERVNJR05JTkcxJDAiBgNVBAMTG0FDIFZBTElELUpVUyBD\nT0RFU0lHTklORyB2NTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAJgs\nbSrlHE1tu/BWqU7DRv54a9pEFCy2jQfQiLrJylQmfOKSqqD6aOsNUwG1dSrsZ8CI\nNoDNcNkP+fxZUml0QpovPyrjQjYDNaoU5lT6wrvmuJIwEoh/la0rmMmiHjGPPGR0\nRgRYSCbhTso/XL3b5ywsRLi9R9EKLuJpZaHsRaILjXR8kpIVyCRBxVl6AfPPSfXW\nhAhlPcvuYfjRJmrOqPM6KHmqJjmJ6CloXNL7RwSK2JXVWLtIxzhj3brGf5mXZnCi\n2t/z7T88Ct53sj7inCsVl4yTkya2AzzRH7AINb+wX/CueXPoXZpCR574J//F5cED\nrwhA09FFpx30iNvyVbJHlzGa9YDOlMkcPGCLBWUC3h+CuAt7N6roANbN6+1p2Sms\nFqf3lA4cAXO37Je0xCdYHjGfGT16wdnRDAyUW7NIfT9XiWBV5uB38dQd38Q/I2Cg\n3GXiFDdXypn0s3JkwxqN6hHqIMZSoZAmdiMvO2YKp16vFigAczBx1BVaYtttSc7r\nGvPIWZYxXCBwqFkPTlRmYS0fH4/P3qWZVLfHlym5IHZ/yTazM8ZrGYzJGkLdPRgN\nU33Oxydq2WJI3gJuu527pJ1Q2WH8S7FOUoQRg0n9KyM3PkZptpFFv/5NLI/2gdx6\nmZBGx2toig7CA3C9SL/1ZFHCs4YFlCXjphxxM0shAgMBAAGjggEzMIIBLzCBlQYD\nVR0gBIGNMIGKMEMGB2BMAQIBgVIwODA2BggrBgEFBQcCARYqaHR0cDovL3d3dy5h\nY2p1cy5qdXMuYnIvYWNqdXMvZHBjYWNqdXMucGRmMEMGB2BMAQIDgVAwODA2Bggr\nBgEFBQcCARYqaHR0cDovL3d3dy5hY2p1cy5qdXMuYnIvYWNqdXMvZHBjYWNqdXMu\ncGRmMDQGA1UdHwQtMCswKaAnoCWGI2h0dHA6Ly9sY3IuYWNqdXMuanVzLmJyL2Fj\nanVzdjUuY3JsMB8GA1UdIwQYMBaAFJkm7gHzr3udmBUE6U2lOgQ3mAuAMB0GA1Ud\nDgQWBBTUjp6StF4pKzZejVhpneG0++1IajAPBgNVHRMBAf8EBTADAQH/MA4GA1Ud\nDwEB/wQEAwIBBjANBgkqhkiG9w0BAQ0FAAOCAgEAa3XVj+2A5xB179jy/0PCZ1YT\nKXtzmD7GSx7EZf9C4dUfEvjuiBQK4mHqU5z6gagsq73gJIW2pWVZZuU+qWrRUht2\n3oqumoQl+uV3OJfImGdoPq9DSoL3rTX5JIpdzkUs/+x0+v+fGxQURcby3Kw0/HIq\nuN92kxIEH1YHnkRWbT2euBYW136z76848AUdICFcOD00SbxFzlGDZWiLBFq3g5aG\n2ULBSTJWd3t2c7lLOx5iGXJ+Nw7fZ3ucRVzl92HdP5AGVqBb4acODKTTOIYnhPZQ\nAr/iTU65l/SVk81SASUJ2ydGQ9lPpVlefScROVwvCgEKU6MS7WtV+31LJ8i5xtUP\nkGEIw6+xHPw+WSyRv1qxm+DnAKjAZOGCfLktZKfNxmnqAur8MCpq6QoET9zlDl6r\nYpHpDnMYKLWDi/01gZ2HRBcyXgSO+ibQaGX9O1Kym1KeazbLrTWabu/M+QPMi1yZ\nzim3FgTNgm8n0PHLWOK5kMHSYaj6ENojiSNnM55aSl7ZRuOe3D3NqcpMJzo5hN+Q\nPDzfkDiKtLH/3IKrWMa+0FQwK98ue3okWKBKylTBgspa0AcvulJ4FgAK1qiA2bHd\nC1x9fsyra/fUV6IY8tRsvH4WkAE2IzhEq/eK3Md4cJsZbEsM9iv1uigAm72gY/q8\nN57wRc6sIZXLdTxlg9E=\n-----END CERTIFICATE-----";
    CAStoreClass store;

    EXPECT_EQ(store.AddCA_PEM(pem), false);
}

TEST(CAStoreClassTest, AddCA_3) {
        // Autoridade_Certificadora_da_Justica_v5.crt
    const char *pem1 = "-----BEGIN CERTIFICATE-----\nMIIGWTCCBEGgAwIBAgIBBzANBgkqhkiG9w0BAQ0FADCBlzELMAkGA1UEBhMCQlIx\nEzARBgNVBAoMCklDUC1CcmFzaWwxPTA7BgNVBAsMNEluc3RpdHV0byBOYWNpb25h\nbCBkZSBUZWNub2xvZ2lhIGRhIEluZm9ybWFjYW8gLSBJVEkxNDAyBgNVBAMMK0F1\ndG9yaWRhZGUgQ2VydGlmaWNhZG9yYSBSYWl6IEJyYXNpbGVpcmEgdjUwHhcNMTYx\nMDE5MTIxODIxWhcNMjkwMzAyMTIwMDIxWjCBiTELMAkGA1UEBhMCQlIxEzARBgNV\nBAoMCklDUC1CcmFzaWwxNDAyBgNVBAsMK0F1dG9yaWRhZGUgQ2VydGlmaWNhZG9y\nYSBSYWl6IEJyYXNpbGVpcmEgdjUxLzAtBgNVBAMMJkF1dG9yaWRhZGUgQ2VydGlm\naWNhZG9yYSBkYSBKdXN0aWNhIHY1MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIIC\nCgKCAgEA1VwO99CodJRRSdTWyG9BLRp69RvpxhXg6PQIZapVNpwrliYZL3DKU5yP\nb5XaE4aBFfWPpEM5tfMvEfwAGxCRhyR7d9dnKC5vDeFbsNK5k+e5Vllpsr//jfpZ\nLZWWnyOqhI2yRwngkYlI1QyiPh0v+jvHYi2XlysxjcOU1L75L3s9iC1hWnmsF8w9\nFzNKfPlz6KmRTCg8Sv29pv56FXkBnW4lOoov87chYZ7kW6DBAeOvAXPwdlF4+vRP\nqn7iSFzibFcb9CxQpgFmjfxV3Zn7lZ/g3zeyQoYIHReh+oWmhXj+NpTsMqsE050c\nGZJ6p4lfRcK6dtZIn4ki5lf7xnOQbIQAiGWh4LgvsA+sgLpC/ZVeRWiJUTOQT7Tm\n5KNzX512XLxb5EJ6ew8hkQf9pWwnZDOewOMdlc1edSBC4RpmJrfBcTiERG5Z8Ehx\nv0WbSk8ktXhvobrnoCqCjDWRvkGc+zQMywWyWyniSqi1K9LZs4v+aWgYrnuv83fM\nxlIA1FTw1m7Cj5OKGRQ2uoqA/NFQMLDOLwXWrfMVBkPqCmFiWrw/BZPJr7KV8jVZ\ntcmdnzcvPh66iVdWlLXXKFbR6tzTiCDzN/NBlDiiVvlxhsWcM1J6TZFUu6u5TPr9\nRFfGXFm7+F8nQRmNurddZE8qBKCwPZVZ2fCV27zMUh0C/IGEnT0CAwEAAaOBuzCB\nuDAdBgNVHQ4EFgQUmSbuAfOve52YFQTpTaU6BDeYC4AwDwYDVR0TAQH/BAUwAwEB\n/zAOBgNVHQ8BAf8EBAMCAQYwFAYDVR0gBA0wCzAJBgVgTAEBEzAAMD8GA1UdHwQ4\nMDYwNKAyoDCGLmh0dHA6Ly9hY3JhaXouaWNwYnJhc2lsLmdvdi5ici9MQ1JhY3Jh\naXp2NS5jcmwwHwYDVR0jBBgwFoAUaai+ddnE72znE0XkYW7laPi2QF4wDQYJKoZI\nhvcNAQENBQADggIBAHj1XLidXFF77nnmEJOwTtCeXP6zf3LTOw/KQunPbR4tr+LG\ngRC0LLN2q+spjF8hvxzXgv99AzLx2AM+as5LkfSspChMJS9U3jmy8gDGRUHvAkXJ\nuBJhPSl0qBmBAmya142QD/52Z3FnZjDSh263TmOvGWfcpQZ9zLTcA5SCUicmg6nA\nijuFJxzTDU1caZzZQruYL1qhSvyN5fQV5VTDzZmrcfcIgYJX7PCn4srPRol0jUcj\nOgkgaQJ35ZCzsSm5FgCgLjWv+7DuYeBT/s9wVE6/U3jD4hTzhXyRWrQz1HPSzvGf\nENCDmqHmuv88bzfMfSH0I/xTj7jbjo4hezgz9MCtZNF/aX4KWQreLp8+LtO/vbic\nT+4IZj93ta3Ba2EginYsWT5q5tdxuT4UfMvr/4lqq+ESry7o3dIh+LJjJgPVk9vb\nXMYHSBvjlGXb3+NOMd+1CTE7w/QdbPWZVANVS1fAKEQHotaXQZSMkC/AAdlRR2Eh\niijnMSE+XlGHv4HDogvqFh/diQY4jUMeDI5JMWlL2HrR5UHt6rIEAspiPwwV4bOm\ni2TAQBUQNeOoqaDVjimOlCxtoHG+FqWTsQF4o5K+BbgCbzg1Cw5ysiG2fITHWSZx\nlcjLGNVFabr8kBjLMQFayVnmj0c8yprod+dHY4bi8uTJuQpmTzxaQNrTws2V\n-----END CERTIFICATE-----";
    // AC_VALID-JUS_CODESIGNING_v5.crt
    const char *pem2 = "-----BEGIN CERTIFICATE-----\nMIIGyjCCBLKgAwIBAgIBDjANBgkqhkiG9w0BAQ0FADCBiTELMAkGA1UEBhMCQlIx\nEzARBgNVBAoMCklDUC1CcmFzaWwxNDAyBgNVBAsMK0F1dG9yaWRhZGUgQ2VydGlm\naWNhZG9yYSBSYWl6IEJyYXNpbGVpcmEgdjUxLzAtBgNVBAMMJkF1dG9yaWRhZGUg\nQ2VydGlmaWNhZG9yYSBkYSBKdXN0aWNhIHY1MB4XDTE3MTIxOTEzNTIxOVoXDTI5\nMDIyMDEzNTIxOVowgY8xCzAJBgNVBAYTAkJSMRMwEQYDVQQKEwpJQ1AtQnJhc2ls\nMS8wLQYDVQQLEyZBdXRvcmlkYWRlIENlcnRpZmljYWRvcmEgZGEgSnVzdGljYSB2\nNTEUMBIGA1UECxMLQ09ERVNJR05JTkcxJDAiBgNVBAMTG0FDIFZBTElELUpVUyBD\nT0RFU0lHTklORyB2NTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAJgs\nbSrlHE1tu/BWqU7DRv54a9pEFCy2jQfQiLrJylQmfOKSqqD6aOsNUwG1dSrsZ8CI\nNoDNcNkP+fxZUml0QpovPyrjQjYDNaoU5lT6wrvmuJIwEoh/la0rmMmiHjGPPGR0\nRgRYSCbhTso/XL3b5ywsRLi9R9EKLuJpZaHsRaILjXR8kpIVyCRBxVl6AfPPSfXW\nhAhlPcvuYfjRJmrOqPM6KHmqJjmJ6CloXNL7RwSK2JXVWLtIxzhj3brGf5mXZnCi\n2t/z7T88Ct53sj7inCsVl4yTkya2AzzRH7AINb+wX/CueXPoXZpCR574J//F5cED\nrwhA09FFpx30iNvyVbJHlzGa9YDOlMkcPGCLBWUC3h+CuAt7N6roANbN6+1p2Sms\nFqf3lA4cAXO37Je0xCdYHjGfGT16wdnRDAyUW7NIfT9XiWBV5uB38dQd38Q/I2Cg\n3GXiFDdXypn0s3JkwxqN6hHqIMZSoZAmdiMvO2YKp16vFigAczBx1BVaYtttSc7r\nGvPIWZYxXCBwqFkPTlRmYS0fH4/P3qWZVLfHlym5IHZ/yTazM8ZrGYzJGkLdPRgN\nU33Oxydq2WJI3gJuu527pJ1Q2WH8S7FOUoQRg0n9KyM3PkZptpFFv/5NLI/2gdx6\nmZBGx2toig7CA3C9SL/1ZFHCs4YFlCXjphxxM0shAgMBAAGjggEzMIIBLzCBlQYD\nVR0gBIGNMIGKMEMGB2BMAQIBgVIwODA2BggrBgEFBQcCARYqaHR0cDovL3d3dy5h\nY2p1cy5qdXMuYnIvYWNqdXMvZHBjYWNqdXMucGRmMEMGB2BMAQIDgVAwODA2Bggr\nBgEFBQcCARYqaHR0cDovL3d3dy5hY2p1cy5qdXMuYnIvYWNqdXMvZHBjYWNqdXMu\ncGRmMDQGA1UdHwQtMCswKaAnoCWGI2h0dHA6Ly9sY3IuYWNqdXMuanVzLmJyL2Fj\nanVzdjUuY3JsMB8GA1UdIwQYMBaAFJkm7gHzr3udmBUE6U2lOgQ3mAuAMB0GA1Ud\nDgQWBBTUjp6StF4pKzZejVhpneG0++1IajAPBgNVHRMBAf8EBTADAQH/MA4GA1Ud\nDwEB/wQEAwIBBjANBgkqhkiG9w0BAQ0FAAOCAgEAa3XVj+2A5xB179jy/0PCZ1YT\nKXtzmD7GSx7EZf9C4dUfEvjuiBQK4mHqU5z6gagsq73gJIW2pWVZZuU+qWrRUht2\n3oqumoQl+uV3OJfImGdoPq9DSoL3rTX5JIpdzkUs/+x0+v+fGxQURcby3Kw0/HIq\nuN92kxIEH1YHnkRWbT2euBYW136z76848AUdICFcOD00SbxFzlGDZWiLBFq3g5aG\n2ULBSTJWd3t2c7lLOx5iGXJ+Nw7fZ3ucRVzl92HdP5AGVqBb4acODKTTOIYnhPZQ\nAr/iTU65l/SVk81SASUJ2ydGQ9lPpVlefScROVwvCgEKU6MS7WtV+31LJ8i5xtUP\nkGEIw6+xHPw+WSyRv1qxm+DnAKjAZOGCfLktZKfNxmnqAur8MCpq6QoET9zlDl6r\nYpHpDnMYKLWDi/01gZ2HRBcyXgSO+ibQaGX9O1Kym1KeazbLrTWabu/M+QPMi1yZ\nzim3FgTNgm8n0PHLWOK5kMHSYaj6ENojiSNnM55aSl7ZRuOe3D3NqcpMJzo5hN+Q\nPDzfkDiKtLH/3IKrWMa+0FQwK98ue3okWKBKylTBgspa0AcvulJ4FgAK1qiA2bHd\nC1x9fsyra/fUV6IY8tRsvH4WkAE2IzhEq/eK3Md4cJsZbEsM9iv1uigAm72gY/q8\nN57wRc6sIZXLdTxlg9E=\n-----END CERTIFICATE-----";
    CAStoreClass store;

    EXPECT_EQ(store.AddCA_PEM(pem1), true);
    EXPECT_EQ(store.AddCA_PEM(pem2), true);
}

TEST(CAStoreClassTest, AddCA_4) {
        // Autoridade_Certificadora_da_Justica_v5.crt
    const char *pem1 = "-----BEGIN CERTIFICATE-----\nMIIGWTCCBEGgAwIBAgIBBzANBgkqhkiG9w0BAQ0FADCBlzELMAkGA1UEBhMCQlIx\nEzARBgNVBAoMCklDUC1CcmFzaWwxPTA7BgNVBAsMNEluc3RpdHV0byBOYWNpb25h\nbCBkZSBUZWNub2xvZ2lhIGRhIEluZm9ybWFjYW8gLSBJVEkxNDAyBgNVBAMMK0F1\ndG9yaWRhZGUgQ2VydGlmaWNhZG9yYSBSYWl6IEJyYXNpbGVpcmEgdjUwHhcNMTYx\nMDE5MTIxODIxWhcNMjkwMzAyMTIwMDIxWjCBiTELMAkGA1UEBhMCQlIxEzARBgNV\nBAoMCklDUC1CcmFzaWwxNDAyBgNVBAsMK0F1dG9yaWRhZGUgQ2VydGlmaWNhZG9y\nYSBSYWl6IEJyYXNpbGVpcmEgdjUxLzAtBgNVBAMMJkF1dG9yaWRhZGUgQ2VydGlm\naWNhZG9yYSBkYSBKdXN0aWNhIHY1MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIIC\nCgKCAgEA1VwO99CodJRRSdTWyG9BLRp69RvpxhXg6PQIZapVNpwrliYZL3DKU5yP\nb5XaE4aBFfWPpEM5tfMvEfwAGxCRhyR7d9dnKC5vDeFbsNK5k+e5Vllpsr//jfpZ\nLZWWnyOqhI2yRwngkYlI1QyiPh0v+jvHYi2XlysxjcOU1L75L3s9iC1hWnmsF8w9\nFzNKfPlz6KmRTCg8Sv29pv56FXkBnW4lOoov87chYZ7kW6DBAeOvAXPwdlF4+vRP\nqn7iSFzibFcb9CxQpgFmjfxV3Zn7lZ/g3zeyQoYIHReh+oWmhXj+NpTsMqsE050c\nGZJ6p4lfRcK6dtZIn4ki5lf7xnOQbIQAiGWh4LgvsA+sgLpC/ZVeRWiJUTOQT7Tm\n5KNzX512XLxb5EJ6ew8hkQf9pWwnZDOewOMdlc1edSBC4RpmJrfBcTiERG5Z8Ehx\nv0WbSk8ktXhvobrnoCqCjDWRvkGc+zQMywWyWyniSqi1K9LZs4v+aWgYrnuv83fM\nxlIA1FTw1m7Cj5OKGRQ2uoqA/NFQMLDOLwXWrfMVBkPqCmFiWrw/BZPJr7KV8jVZ\ntcmdnzcvPh66iVdWlLXXKFbR6tzTiCDzN/NBlDiiVvlxhsWcM1J6TZFUu6u5TPr9\nRFfGXFm7+F8nQRmNurddZE8qBKCwPZVZ2fCV27zMUh0C/IGEnT0CAwEAAaOBuzCB\nuDAdBgNVHQ4EFgQUmSbuAfOve52YFQTpTaU6BDeYC4AwDwYDVR0TAQH/BAUwAwEB\n/zAOBgNVHQ8BAf8EBAMCAQYwFAYDVR0gBA0wCzAJBgVgTAEBEzAAMD8GA1UdHwQ4\nMDYwNKAyoDCGLmh0dHA6Ly9hY3JhaXouaWNwYnJhc2lsLmdvdi5ici9MQ1JhY3Jh\naXp2NS5jcmwwHwYDVR0jBBgwFoAUaai+ddnE72znE0XkYW7laPi2QF4wDQYJKoZI\nhvcNAQENBQADggIBAHj1XLidXFF77nnmEJOwTtCeXP6zf3LTOw/KQunPbR4tr+LG\ngRC0LLN2q+spjF8hvxzXgv99AzLx2AM+as5LkfSspChMJS9U3jmy8gDGRUHvAkXJ\nuBJhPSl0qBmBAmya142QD/52Z3FnZjDSh263TmOvGWfcpQZ9zLTcA5SCUicmg6nA\nijuFJxzTDU1caZzZQruYL1qhSvyN5fQV5VTDzZmrcfcIgYJX7PCn4srPRol0jUcj\nOgkgaQJ35ZCzsSm5FgCgLjWv+7DuYeBT/s9wVE6/U3jD4hTzhXyRWrQz1HPSzvGf\nENCDmqHmuv88bzfMfSH0I/xTj7jbjo4hezgz9MCtZNF/aX4KWQreLp8+LtO/vbic\nT+4IZj93ta3Ba2EginYsWT5q5tdxuT4UfMvr/4lqq+ESry7o3dIh+LJjJgPVk9vb\nXMYHSBvjlGXb3+NOMd+1CTE7w/QdbPWZVANVS1fAKEQHotaXQZSMkC/AAdlRR2Eh\niijnMSE+XlGHv4HDogvqFh/diQY4jUMeDI5JMWlL2HrR5UHt6rIEAspiPwwV4bOm\ni2TAQBUQNeOoqaDVjimOlCxtoHG+FqWTsQF4o5K+BbgCbzg1Cw5ysiG2fITHWSZx\nlcjLGNVFabr8kBjLMQFayVnmj0c8yprod+dHY4bi8uTJuQpmTzxaQNrTws2V\n-----END CERTIFICATE-----";
    // AC_VALID-JUS_CODESIGNING_v5.crt
    const char *pem2 = "-----BEGIN CERTIFICATE-----\nMIIGyjCCBLKgAwIBAgIBDjANBgkqhkiG9w0BAQ0FADCBiTELMAkGA1UEBhMCQlIx\nEzARBgNVBAoMCklDUC1CcmFzaWwxNDAyBgNVBAsMK0F1dG9yaWRhZGUgQ2VydGlm\naWNhZG9yYSBSYWl6IEJyYXNpbGVpcmEgdjUxLzAtBgNVBAMMJkF1dG9yaWRhZGUg\nQ2VydGlmaWNhZG9yYSBkYSBKdXN0aWNhIHY1MB4XDTE3MTIxOTEzNTIxOVoXDTI5\nMDIyMDEzNTIxOVowgY8xCzAJBgNVBAYTAkJSMRMwEQYDVQQKEwpJQ1AtQnJhc2ls\nMS8wLQYDVQQLEyZBdXRvcmlkYWRlIENlcnRpZmljYWRvcmEgZGEgSnVzdGljYSB2\nNTEUMBIGA1UECxMLQ09ERVNJR05JTkcxJDAiBgNVBAMTG0FDIFZBTElELUpVUyBD\nT0RFU0lHTklORyB2NTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAJgs\nbSrlHE1tu/BWqU7DRv54a9pEFCy2jQfQiLrJylQmfOKSqqD6aOsNUwG1dSrsZ8CI\nNoDNcNkP+fxZUml0QpovPyrjQjYDNaoU5lT6wrvmuJIwEoh/la0rmMmiHjGPPGR0\nRgRYSCbhTso/XL3b5ywsRLi9R9EKLuJpZaHsRaILjXR8kpIVyCRBxVl6AfPPSfXW\nhAhlPcvuYfjRJmrOqPM6KHmqJjmJ6CloXNL7RwSK2JXVWLtIxzhj3brGf5mXZnCi\n2t/z7T88Ct53sj7inCsVl4yTkya2AzzRH7AINb+wX/CueXPoXZpCR574J//F5cED\nrwhA09FFpx30iNvyVbJHlzGa9YDOlMkcPGCLBWUC3h+CuAt7N6roANbN6+1p2Sms\nFqf3lA4cAXO37Je0xCdYHjGfGT16wdnRDAyUW7NIfT9XiWBV5uB38dQd38Q/I2Cg\n3GXiFDdXypn0s3JkwxqN6hHqIMZSoZAmdiMvO2YKp16vFigAczBx1BVaYtttSc7r\nGvPIWZYxXCBwqFkPTlRmYS0fH4/P3qWZVLfHlym5IHZ/yTazM8ZrGYzJGkLdPRgN\nU33Oxydq2WJI3gJuu527pJ1Q2WH8S7FOUoQRg0n9KyM3PkZptpFFv/5NLI/2gdx6\nmZBGx2toig7CA3C9SL/1ZFHCs4YFlCXjphxxM0shAgMBAAGjggEzMIIBLzCBlQYD\nVR0gBIGNMIGKMEMGB2BMAQIBgVIwODA2BggrBgEFBQcCARYqaHR0cDovL3d3dy5h\nY2p1cy5qdXMuYnIvYWNqdXMvZHBjYWNqdXMucGRmMEMGB2BMAQIDgVAwODA2Bggr\nBgEFBQcCARYqaHR0cDovL3d3dy5hY2p1cy5qdXMuYnIvYWNqdXMvZHBjYWNqdXMu\ncGRmMDQGA1UdHwQtMCswKaAnoCWGI2h0dHA6Ly9sY3IuYWNqdXMuanVzLmJyL2Fj\nanVzdjUuY3JsMB8GA1UdIwQYMBaAFJkm7gHzr3udmBUE6U2lOgQ3mAuAMB0GA1Ud\nDgQWBBTUjp6StF4pKzZejVhpneG0++1IajAPBgNVHRMBAf8EBTADAQH/MA4GA1Ud\nDwEB/wQEAwIBBjANBgkqhkiG9w0BAQ0FAAOCAgEAa3XVj+2A5xB179jy/0PCZ1YT\nKXtzmD7GSx7EZf9C4dUfEvjuiBQK4mHqU5z6gagsq73gJIW2pWVZZuU+qWrRUht2\n3oqumoQl+uV3OJfImGdoPq9DSoL3rTX5JIpdzkUs/+x0+v+fGxQURcby3Kw0/HIq\nuN92kxIEH1YHnkRWbT2euBYW136z76848AUdICFcOD00SbxFzlGDZWiLBFq3g5aG\n2ULBSTJWd3t2c7lLOx5iGXJ+Nw7fZ3ucRVzl92HdP5AGVqBb4acODKTTOIYnhPZQ\nAr/iTU65l/SVk81SASUJ2ydGQ9lPpVlefScROVwvCgEKU6MS7WtV+31LJ8i5xtUP\nkGEIw6+xHPw+WSyRv1qxm+DnAKjAZOGCfLktZKfNxmnqAur8MCpq6QoET9zlDl6r\nYpHpDnMYKLWDi/01gZ2HRBcyXgSO+ibQaGX9O1Kym1KeazbLrTWabu/M+QPMi1yZ\nzim3FgTNgm8n0PHLWOK5kMHSYaj6ENojiSNnM55aSl7ZRuOe3D3NqcpMJzo5hN+Q\nPDzfkDiKtLH/3IKrWMa+0FQwK98ue3okWKBKylTBgspa0AcvulJ4FgAK1qiA2bHd\nC1x9fsyra/fUV6IY8tRsvH4WkAE2IzhEq/eK3Md4cJsZbEsM9iv1uigAm72gY/q8\nN57wRc6sIZXLdTxlg9E=\n-----END CERTIFICATE-----";
    CAStoreClass store;

    EXPECT_EQ(store.AddCA_PEM(pem2), false);
    EXPECT_EQ(store.AddCA_PEM(pem1), true);
}