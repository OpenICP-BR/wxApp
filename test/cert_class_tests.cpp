#include "cert_class.h"
#include "gtest/gtest.h"

TEST(cert_class_test, load_and_parse_pem_1) {
	const char *pem = "-----BEGIN CERTIFICATE-----\nMIIEMjCCAhoCAhAEMA0GCSqGSIb3DQEBCwUAMEAxCzAJBgNVBAYTAkJSMQswCQYD\nVQQIDAJGTjERMA8GA1UECgwIRmFrZUJhbmsxETAPBgNVBAMMCEZha2VCYW5rMB4X\nDTE4MDUwMzE4NDQxMloXDTE5MDUxMzE4NDQxMlowfTELMAkGA1UEBhMCQlIxCzAJ\nBgNVBAgMAkZOMQ0wCwYDVQQHDARJbGhhMRAwDgYDVQQKDAdGYWtlUEtJMRwwGgYD\nVQQDDBNDaWNsYW5vIENpY2xhbsOzaWRlMSIwIAYJKoZIhvcNAQkBFhNjaWNsYW5v\nQGV4YW1wbGUuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtisx\nUQVMBok9YmudWUub1IGDFSyq68OARHD5Rajdu0Ap9kmXv662kMMwJDeMn+hZSuww\n+5nrezSG7N0fqtBJf9mdyIf2JnEYnfkT65eyNbQjyKogzM++RYQ7K+maPEeo/ip1\nues2kC2+VkalRSGkbBKd5tvvbI9fPprVdT5Ky+/GNVAkva0elPVpEJh4jEMqalPT\nx18xCPXNYb7U7QdJf3oIETr5BtLBcmffVggYcDiYX+BwA5701YjwbuHmJ/I+mD1M\nF6IDosvCVaXXprfJkrjUoY/kS2hcWLAb4SYMJwcK/fo4IS9+OHQ4APqjLSuj1phz\nIPJV3UfrtM9KYCfDtwIDAQABMA0GCSqGSIb3DQEBCwUAA4ICAQDDiMj07xBFtte6\nn1WbfKKBTARnBA9K6egbKeKtOjRJPpv3SKUE8Np55rNMH5Rtv8sLwUEgIR1K/Hep\nSPseOQ41rmvsy3XUx/ohw/yAo6dgNUvY8ZpXZvRreObe42rdi22bU3fNlrduArF5\nUvFlgM03KKzpnm64JNuc5tZ+NoZDUmKruZlB6h481xBCRUxElCMMC52r2/jvUz+d\nAWwdi3DvZlhr+Fdv/aUrQwrecJ/0Ot8h9w18GeurygyLO6Z/C7lKN7sfy49gJzHG\nnhlvKkl7sN6ZJ/mI+IEnc4F+9Bnfohj1rQFKeVjNH4lOb5F6ZnmzOyvwIoNBUTmk\n8rfOphcxhQmSvSrl4xGDOD6LrL5GUt+D8V9dj8nFnVidWR9vJzTXPgjucZy9CFb4\nzBdc9jPL544x3xmoCQfZIrKTKsJDmujjbFooF2V0VxGWZ+uXQmHy53kgiHbvCU7G\nThSAHv4vM8PSWSYKZ0FRC3LYJaULhuJGw5j/YDN2lF8utkMEsodEjwjeShR49Wmu\ns2tjSJmqSRqnkFkIX4d1twqEakBtqTMGbVuArMm+pXA42RGLaLHH/3/EreXrp8A0\nAT40KxMmK4+e9ioRmSm2D+CAi+nFTQKsr13Q9aosuCt/vboTTB4D5LlQU7AITsyp\ny+5qaw5AI5Hl+ogIxTW2LmqmuPNXMA==\n-----END CERTIFICATE-----";
    CertClass cert;
    EXPECT_EQ(cert.LoadPEMString(pem), true);
}